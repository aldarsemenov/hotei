{"ast":null,"code":"import { createAsyncThunk, createSlice } from \"@reduxjs/toolkit\";\nimport axios from \"axios\";\nconst cartStorageString = localStorage.getItem(\"cart\");\nconst initialState = {\n  loading: \"initial\",\n  items: []\n};\nexport const makeOrder = createAsyncThunk(\"cart/makeOrder\", async orderData => {\n  console.log(orderData);\n  return axios.post(\"http://localhost:1337/api/orders\", {\n    data: orderData\n  }).then(r => r.data);\n});\nexport const cartSlice = createSlice({\n  name: \"cart\",\n  initialState: cartStorageString ? JSON.parse(cartStorageString) : initialState,\n  reducers: {\n    addToCart: (state, action) => {\n      let itemToAdd = action.payload;\n      let index = state.items.findIndex(item => item.food.id === itemToAdd.id);\n      if (index >= 0) {\n        state.items[index].qty++;\n      } else {\n        state.items.push({\n          qty: 1,\n          food: itemToAdd\n        });\n      }\n    },\n    clearCart: state => {\n      state.items.length = 0;\n    },\n    increaseItemQty: (state, action) => {\n      let index = state.items.findIndex(item => item.food.id === action.payload);\n      state.items[index].qty++;\n    },\n    decreaseItemQty: (state, action) => {\n      let index = state.items.findIndex(item => item.food.id === action.payload);\n      state.items[index].qty--;\n      if (!state.items[index].qty) state.items.splice(index, 1);\n    }\n  },\n  extraReducers: builder => {\n    builder.addCase(makeOrder.fulfilled, (state, action) => {\n      state.loading = \"fulfilled\";\n      state.items.length = 0;\n    });\n    builder.addCase(makeOrder.pending, (state, action) => {\n      state.loading = \"pending\";\n    });\n    builder.addCase(makeOrder.rejected, (state, action) => {\n      console.log(action.error);\n      state.loading = \"rejected\";\n    });\n  }\n});\n\n// Action creators are generated for each case reducer function\nexport const {\n  addToCart,\n  clearCart,\n  increaseItemQty,\n  decreaseItemQty\n} = cartSlice.actions;\nexport default cartSlice.reducer;","map":{"version":3,"names":["createAsyncThunk","createSlice","axios","cartStorageString","localStorage","getItem","initialState","loading","items","makeOrder","orderData","console","log","post","data","then","r","cartSlice","name","JSON","parse","reducers","addToCart","state","action","itemToAdd","payload","index","findIndex","item","food","id","qty","push","clearCart","length","increaseItemQty","decreaseItemQty","splice","extraReducers","builder","addCase","fulfilled","pending","rejected","error","actions","reducer"],"sources":["/Users/aldarsemenov/react/hotei/hotei/src/store/slices/cartSlice.js"],"sourcesContent":["import { createAsyncThunk, createSlice } from \"@reduxjs/toolkit\";\nimport axios from \"axios\";\n\nconst cartStorageString = localStorage.getItem(\"cart\");\n\nconst initialState = { loading: \"initial\", items: [] };\n\nexport const makeOrder = createAsyncThunk(\n  \"cart/makeOrder\",\n  async (orderData) => {\n    console.log(orderData);\n    return axios\n      .post(\"http://localhost:1337/api/orders\", { data: orderData })\n      .then((r) => r.data);\n  }\n);\n\nexport const cartSlice = createSlice({\n  name: \"cart\",\n  initialState: cartStorageString\n    ? JSON.parse(cartStorageString)\n    : initialState,\n  reducers: {\n    addToCart: (state, action) => {\n      let itemToAdd = action.payload;\n      let index = state.items.findIndex(\n        (item) => item.food.id === itemToAdd.id\n      );\n      if (index >= 0) {\n        state.items[index].qty++;\n      } else {\n        state.items.push({ qty: 1, food: itemToAdd });\n      }\n    },\n    clearCart: (state) => {\n      state.items.length = 0;\n    },\n    increaseItemQty: (state, action) => {\n      let index = state.items.findIndex(\n        (item) => item.food.id === action.payload\n      );\n      state.items[index].qty++;\n    },\n    decreaseItemQty: (state, action) => {\n      let index = state.items.findIndex(\n        (item) => item.food.id === action.payload\n      );\n      state.items[index].qty--;\n      if (!state.items[index].qty) state.items.splice(index, 1);\n    },\n  },\n  extraReducers: (builder) => {\n    builder.addCase(makeOrder.fulfilled, (state, action) => {\n      state.loading = \"fulfilled\";\n      state.items.length = 0;\n    });\n    builder.addCase(makeOrder.pending, (state, action) => {\n      state.loading = \"pending\";\n    });\n    builder.addCase(makeOrder.rejected, (state, action) => {\n      console.log(action.error);\n      state.loading = \"rejected\";\n    });\n  },\n});\n\n// Action creators are generated for each case reducer function\nexport const { addToCart, clearCart, increaseItemQty, decreaseItemQty } =\n  cartSlice.actions;\n\nexport default cartSlice.reducer;"],"mappings":"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"},"metadata":{},"sourceType":"module","externalDependencies":[]}